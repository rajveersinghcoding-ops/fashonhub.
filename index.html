<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FashionHub - Modern Clothing Store</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #3498db;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--dark-color);
            background-color: #f8f9fa;
        }
        
        .navbar {
            background-color: var(--primary-color);
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: white !important;
        }
        
        .nav-link {
            color: rgba(255,255,255,.8) !important;
            font-weight: 500;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: white !important;
        }
        
        .category-nav {
            display: flex;
            gap: 10px;
            margin-left: 20px;
        }
        
        .category-btn {
            background-color: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }
        
        .category-btn:hover {
            background-color: rgba(255,255,255,0.2);
            color: white;
        }
        
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 100px 0;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .hero-section h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .product-card {
            border: none;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 30px;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,.1);
        }
        
        .product-card img {
            height: 250px;
            object-fit: cover;
            width: 100%;
        }
        
        .product-card .card-body {
            padding: 20px;
        }
        
        .product-card .card-title {
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .product-card .price {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--dark-color);
            border-color: var(--dark-color);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background-color: var(--secondary-color);
        }
        
        .footer {
            background-color: var(--primary-color);
            color: white;
            padding: 40px 0;
            margin-top: 60px;
        }
        
        .footer h5 {
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .footer ul {
            list-style: none;
            padding: 0;
        }
        
        .footer ul li {
            margin-bottom: 10px;
        }
        
        .footer a {
            color: rgba(255,255,255,.8);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer a:hover {
            color: white;
        }
        
        .cart-icon {
            position: relative;
        }
        
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .product-detail-img {
            height: 400px;
            object-fit: cover;
            border-radius: 8px;
        }
        
        .size-option {
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-right: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .size-option:hover, .size-option.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .review {
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 15px;
        }
        
        .review:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .reviewer-name {
            font-weight: 600;
        }
        
        .review-date {
            color: #777;
            font-size: 0.9rem;
        }
        
        .rating {
            color: #ffc107;
        }
        
        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 15px;
        }
        
        .cart-item-details {
            flex-grow: 1;
        }
        
        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        
        .quantity-control button {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 1px solid #ddd;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity-control input {
            width: 40px;
            height: 30px;
            text-align: center;
            border: 1px solid #ddd;
            border-left: none;
            border-right: none;
        }
        
        .cart-summary {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .cart-summary h4 {
            margin-bottom: 15px;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .summary-row.total {
            font-weight: 700;
            font-size: 1.2rem;
            border-top: 1px solid #ddd;
            padding-top: 10px;
            margin-top: 10px;
        }
        
        .checkout-form {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.25rem rgba(44, 62, 80, 0.25);
        }
        
        .order-history {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,.1);
            overflow: hidden;
        }
        
        .order-history table {
            margin-bottom: 0;
        }
        
        .order-history th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        .admin-panel {
            display: none;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,.1);
            padding: 30px;
            margin-top: 30px;
        }
        
        .admin-panel.active {
            display: block;
        }
        
        .admin-tabs {
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .admin-tab {
            padding: 10px 20px;
            display: inline-block;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
        }
        
        .admin-tab.active {
            border-bottom: 2px solid var(--primary-color);
            font-weight: 600;
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        .product-form {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .admin-product-list {
            margin-top: 20px;
        }
        
        .admin-product-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .admin-product-item:last-child {
            border-bottom: none;
        }
        
        .admin-product-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 15px;
        }
        
        .admin-product-details {
            flex-grow: 1;
        }
        
        .admin-product-actions {
            display: flex;
            gap: 10px;
        }
        
        .login-modal .modal-content {
            border-radius: 8px;
        }
        
        .login-modal .modal-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px 8px 0 0;
        }
        
        .hidden-trigger {
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            height: 20px;
            opacity: 0;
            cursor: pointer;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0,0,0,.1);
            z-index: 1000;
            transform: translateX(120%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .image-upload-container {
            position: relative;
            width: 100%;
            margin-bottom: 15px;
        }
        
        .image-upload-label {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #f8f9fa;
            border: 1px dashed #ddd;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .image-upload-label:hover {
            background-color: #e9ecef;
        }
        
        .image-upload-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .image-preview {
            margin-top: 10px;
            text-align: center;
        }
        
        .image-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 4px;
        }
        
        .admin-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--secondary-color);
            color: white;
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        /* Admin Button Styles - Modified */
        .admin-button {
            position: fixed;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: rgba(231, 76, 60, 0.7);
            color: white;
            display: none; /* Initially hidden */
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            opacity: 0.3;
            transition: opacity 0.3s ease, transform 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .admin-button.visible {
            display: flex;
        }
        
        .admin-button:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 20px;
            border: none;
            width: 80%;
            max-width: 500px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        .self-destruct-btn {
            background-color: #dc3545;
        }
        
        .self-destruct-btn:hover {
            background-color: #c82333;
        }
        
        .uploaded-products {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .product-card-admin {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .product-card-admin img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        
        .product-card-admin .card-body {
            padding: 10px;
        }
        
        .product-card-admin .card-title {
            font-size: 1rem;
            margin-bottom: 5px;
        }
        
        .product-card-admin .card-price {
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .product-card-admin .card-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        /* Media Gallery Styles */
        .media-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .media-item {
            position: relative;
            border-radius: 4px;
            overflow: hidden;
            aspect-ratio: 1/1;
        }
        
        .media-item img,
        .media-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .media-item .remove-media {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(0,0,0,0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .media-item:hover .remove-media {
            opacity: 1;
        }
        
        .media-item .media-type {
            position: absolute;
            bottom: 5px;
            left: 5px;
            background-color: rgba(0,0,0,0.5);
            color: white;
            border-radius: 4px;
            padding: 2px 6px;
            font-size: 10px;
        }
        
        .add-media-btn {
            border: 1px dashed #ddd;
            background-color: #f8f9fa;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .add-media-btn:hover {
            background-color: #e9ecef;
        }
        
        .add-media-btn i {
            font-size: 24px;
            color: #777;
        }
        
        /* Admin Dashboard Styles */
        .admin-dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .admin-dashboard-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        
        .admin-dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .admin-dashboard-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .admin-dashboard-card.upload-product {
            color: #fd7e14;
        }
        
        .admin-dashboard-card.view-purchases {
            color: #0d6efd;
        }
        
        .admin-dashboard-card.manage-products {
            color: #198754;
        }
        
        .admin-dashboard-card.view-messages {
            color: #6f42c1;
        }
        
        .admin-dashboard-card.self-destruct {
            color: #dc3545;
        }
        
        .admin-dashboard-card h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .admin-dashboard-card p {
            color: #6c757d;
            margin-bottom: 0;
        }
        
        @media (max-width: 768px) {
            .hero-section h1 {
                font-size: 2rem;
            }
            
            .product-detail-img {
                height: 300px;
            }
            
            .cart-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .cart-item img {
                margin-bottom: 15px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
            }
            
            .category-nav {
                flex-wrap: wrap;
                margin-top: 10px;
            }
            
            .admin-dashboard-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <div class="d-flex align-items-center">
                <a class="navbar-brand" href="#" id="homeLink">FashionHub</a>
                <div class="category-nav">
                    <button class="category-btn" data-category="men">Men</button>
                    <button class="category-btn" data-category="women">Women</button>
                    <button class="category-btn" data-category="kids">Kids</button>
                    <button class="category-btn" data-category="accessories">Accessories</button>
                    <button class="category-btn" data-category="sale">Sale</button>
                </div>
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-auto d-flex align-items-center">
                    <a href="#" class="text-white me-3" id="cartLink">
                        <i class="bi bi-cart3 cart-icon">
                            <span class="cart-count" id="cartCount">0</span>
                        </i>
                    </a>
                    <div class="hidden-trigger" id="adminTrigger"></div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section" id="heroSection">
        <div class="container">
            <h1>Summer Collection 2025</h1>
            <p class="lead">Discover the latest trends in fashion</p>
            <a href="#" class="btn btn-light btn-lg" id="shopNowBtn">Shop Now</a>
        </div>
    </section>

    <!-- Main Content -->
    <div class="container" id="mainContent">
        <!-- Home Page -->
        <div id="homePage">
            <h2 class="section-title">Featured Products</h2>
            <div class="row" id="featuredProducts">
                <!-- Products will be dynamically loaded here -->
            </div>
        </div>

        <!-- Product Detail Page -->
        <div id="productDetailPage" style="display: none;">
            <div class="row">
                <div class="col-md-6">
                    <img id="productDetailImage" class="product-detail-img" src="" alt="">
                </div>
                <div class="col-md-6">
                    <h2 id="productDetailTitle"></h2>
                    <div class="price" id="productDetailPrice"></div>
                    <p id="productDetailDescription"></p>
                    
                    <div class="mb-3">
                        <h5>Size</h5>
                        <div id="sizeOptions">
                            <!-- Size options will be dynamically loaded here -->
                        </div>
                    </div>
                    
                    <div class="d-flex mb-4">
                        <button class="btn btn-primary me-3" id="addToCartBtn">Add to Cart</button>
                        <button class="btn btn-outline-primary" id="buyNowBtn">Buy Now</button>
                    </div>
                    
                    <div class="mt-5">
                        <h4>Reviews</h4>
                        <div id="productReviews">
                            <!-- Reviews will be dynamically loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shopping Cart Page -->
        <div id="cartPage" style="display: none;">
            <h2 class="section-title">Shopping Cart</h2>
            <div class="row">
                <div class="col-md-8">
                    <div id="cartItems">
                        <!-- Cart items will be dynamically loaded here -->
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="cart-summary">
                        <h4>Order Summary</h4>
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span id="subtotal">$0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping</span>
                            <span id="shipping">$5.99</span>
                        </div>
                        <div class="summary-row">
                            <span>Tax</span>
                            <span id="tax">$0.00</span>
                        </div>
                        <div class="summary-row.total">
                            <span>Total</span>
                            <span id="total">$0.00</span>
                        </div>
                        <button class="btn btn-primary w-100 mt-3" id="checkoutBtn">Proceed to Checkout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checkout Page -->
        <div id="checkoutPage" style="display: none;">
            <h2 class="section-title">Checkout</h2>
            <div class="row">
                <div class="col-md-8">
                    <form class="checkout-form" id="checkoutForm">
                        <h4 class="mb-4">Billing Information</h4>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="firstName">First Name</label>
                                    <input type="text" class="form-control" id="firstName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="lastName">Last Name</label>
                                    <input type="text" class="form-control" id="lastName" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" class="form-control" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" class="form-control" id="address" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="city">City</label>
                                    <input type="text" class="form-control" id="city" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="state">State</label>
                                    <input type="text" class="form-control" id="state" required>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="zip">ZIP</label>
                                    <input type="text" class="form-control" id="zip" required>
                                </div>
                            </div>
                        </div>
                        
                        <h4 class="mb-4 mt-5">Payment Information</h4>
                        <div class="form-group">
                            <label for="cardName">Name on Card</label>
                            <input type="text" class="form-control" id="cardName" required>
                        </div>
                        <div class="form-group">
                            <label for="cardNumber">Card Number</label>
                            <input type="text" class="form-control" id="cardNumber" placeholder="1234 5678 9012 3456" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="expiry">Expiry Date</label>
                                    <input type="text" class="form-control" id="expiry" placeholder="MM/YY" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="cvv">CVV</label>
                                    <input type="text" class="form-control" id="cvv" placeholder="123" required>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-outline-primary" id="backToCartBtn">Back to Cart</button>
                            <button type="submit" class="btn btn-primary">Place Order</button>
                        </div>
                    </form>
                </div>
                <div class="col-md-4">
                    <div class="cart-summary">
                        <h4>Order Summary</h4>
                        <div id="checkoutCartItems">
                            <!-- Cart items will be dynamically loaded here -->
                        </div>
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span id="checkoutSubtotal">$0.00</span>
                        </div>
                        <div class="summary-row">
                            <span>Shipping</span>
                            <span id="checkoutShipping">$5.99</span>
                        </div>
                        <div class="summary-row">
                            <span>Tax</span>
                            <span id="checkoutTax">$0.00</span>
                        </div>
                        <div class="summary-row.total">
                            <span>Total</span>
                            <span id="checkoutTotal">$0.00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Order Confirmation Page -->
        <div id="confirmationPage" style="display: none;">
            <div class="text-center py-5">
                <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
                <h2 class="mt-3">Order Confirmed!</h2>
                <p class="lead">Thank you for your purchase. Your order has been placed successfully.</p>
                <p>Order ID: <strong id="orderId"></strong></p>
                <p>We've sent a confirmation email with your order details.</p>
                <button class="btn btn-primary mt-3" id="continueShoppingBtn">Continue Shopping</button>
            </div>
        </div>

        <!-- Admin Panel -->
        <div id="adminPanel" class="admin-panel">
            <div class="admin-badge">ADMIN PANEL</div>
            <h2 class="section-title">Admin Dashboard</h2>
            
            <div class="admin-dashboard-grid">
                <div class="admin-dashboard-card upload-product" id="uploadProductCard">
                    <i class="fas fa-upload"></i>
                    <h3>Upload Product</h3>
                    <p>Add new products to the store</p>
                </div>
                
                <div class="admin-dashboard-card view-purchases" id="viewPurchasesCard">
                    <i class="fas fa-shopping-cart"></i>
                    <h3>View Purchases</h3>
                    <p>Check customer orders</p>
                </div>
                
                <div class="admin-dashboard-card manage-products" id="manageProductsCard">
                    <i class="fas fa-box"></i>
                    <h3>Manage Products</h3>
                    <p>Edit or remove products</p>
                </div>
                
                <div class="admin-dashboard-card view-messages" id="viewMessagesCard">
                    <i class="fas fa-envelope"></i>
                    <h3>View Messages</h3>
                    <p>Read customer inquiries</p>
                </div>
                
                <div class="admin-dashboard-card self-destruct" id="selfDestructCard">
                    <i class="fas fa-bomb"></i>
                    <h3>Self Destruct</h3>
                    <p>Reset all data</p>
                </div>
            </div>
            
            <div class="admin-tabs mt-4">
                <div class="admin-tab active" data-tab="products">Products</div>
                <div class="admin-tab" data-tab="orders">Orders</div>
            </div>
            
            <div class="admin-tab-content active" id="productsTab">
                <div class="product-form">
                    <h4>Add New Product</h4>
                    <form id="addProductForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="productName">Product Name</label>
                                    <input type="text" class="form-control" id="productName" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="productPrice">Price ($)</label>
                                    <input type="number" class="form-control" id="productPrice" step="0.01" required>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="productCategory">Category</label>
                            <select class="form-control" id="productCategory" required>
                                <option value="">Select Category</option>
                                <option value="men">Men</option>
                                <option value="women">Women</option>
                                <option value="kids">Kids</option>
                                <option value="accessories">Accessories</option>
                                <option value="sale">Sale</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="productSizes">Sizes (comma separated)</label>
                            <input type="text" class="form-control" id="productSizes" placeholder="e.g., S,M,L,XL">
                        </div>
                        <div class="form-group">
                            <label for="productDescription">Description</label>
                            <textarea class="form-control" id="productDescription" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>Product Images & Videos</label>
                            <div class="image-upload-container">
                                <label for="productMedia" class="image-upload-label">
                                    <i class="bi bi-cloud-upload"></i> Click to upload images or videos
                                </label>
                                <input type="file" class="image-upload-input" id="productMedia" accept="image/*,video/*" multiple required>
                                <div class="media-gallery" id="mediaGallery">
                                    <!-- Media thumbnails will be added here -->
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary" id="uploadMediaBtn">Upload Media</button>
                        <button type="submit" class="btn btn-success" id="submitProductBtn" disabled>Submit Product</button>
                    </form>
                </div>
                
                <h4>Manage Products</h4>
                <div class="admin-product-list" id="adminProductList">
                    <!-- Products will be dynamically loaded here -->
                </div>
            </div>
            
            <div class="admin-tab-content" id="ordersTab">
                <h4>Order History</h4>
                <div class="order-history">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Date</th>
                                <th>Customer</th>
                                <th>Total</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="orderHistoryTable">
                            <!-- Orders will be dynamically loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>FashionHub</h5>
                    <p>Your one-stop destination for the latest fashion trends and styles.</p>
                </div>
                <div class="col-md-2">
                    <h5>Quick Links</h5>
                    <ul>
                        <li><a href="#" data-category="men">Men</a></li>
                        <li><a href="#" data-category="women">Women</a></li>
                        <li><a href="#" data-category="kids">Kids</a></li>
                        <li><a href="#" data-category="accessories">Accessories</a></li>
                        <li><a href="#" data-category="sale">Sale</a></li>
                    </ul>
                </div>
                <div class="col-md-2">
                    <h5>Customer Service</h5>
                    <ul>
                        <li><a href="#">Contact Us</a></li>
                        <li><a href="#">FAQs</a></li>
                        <li><a href="#">Shipping Policy</a></li>
                        <li><a href="#">Returns & Exchanges</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Newsletter</h5>
                    <p>Subscribe to our newsletter to get updates on new arrivals and special offers.</p>
                    <form class="d-flex">
                        <input type="email" class="form-control me-2" placeholder="Your email">
                        <button class="btn btn-light" type="submit">Subscribe</button>
                    </form>
                </div>
            </div>
            <hr class="my-4 bg-white">
            <div class="text-center">
                <p>&copy; 2025 FashionHub. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Admin Button - Modified -->
    <div class="admin-button" id="adminButton">
        <i class="fas fa-user-shield"></i>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closePasswordModal">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Admin Access</h2>
            <p class="mb-4">Please enter the admin password:</p>
            <input type="password" id="adminPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all duration-300 mb-4" placeholder="Password">
            <button id="submitPassword" class="w-full bg-orange-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-orange-700 transition-colors duration-300">Submit</button>
            <p id="passwordError" class="text-red-500 mt-2 hidden">Incorrect password. Please try again.</p>
        </div>
    </div>

    <!-- Upload Product Modal -->
    <div id="uploadProductModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeUploadProduct">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Upload Product</h2>
            <form id="productForm" class="space-y-4">
                <div>
                    <label for="productName" class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
                    <input type="text" id="productName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" required>
                </div>
                <div>
                    <label for="productCost" class="block text-sm font-medium text-gray-700 mb-1">Cost ($)</label>
                    <input type="number" id="productCost" min="0" step="0.01" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" required>
                </div>
                <div>
                    <label for="productSizesModal" class="block text-sm font-medium text-gray-700 mb-1">Sizes (comma separated)</label>
                    <input type="text" id="productSizesModal" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="e.g., S,M,L,XL">
                </div>
                <div>
                    <label for="productDescription" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                    <textarea id="productDescription" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" required></textarea>
                </div>
                <div>
                    <label for="productCategory" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                    <select id="productCategory" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" required>
                        <option value="">Select a category</option>
                        <option value="men">Men</option>
                        <option value="women">Women</option>
                        <option value="kids">Kids</option>
                        <option value="accessories">Accessories</option>
                        <option value="sale">Sale</option>
                    </select>
                </div>
                <div>
                    <label for="productMediaModal" class="block text-sm font-medium text-gray-700 mb-1">Product Images & Videos</label>
                    <input type="file" id="productMediaModal" multiple accept="image/*,video/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    <p class="text-sm text-gray-500 mt-1">Upload multiple images and videos for the product</p>
                    <div class="media-gallery" id="mediaGalleryModal">
                        <!-- Media thumbnails will be added here -->
                    </div>
                </div>
                <div class="flex space-x-4">
                    <button type="button" class="flex-1 bg-orange-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-orange-700 transition-colors duration-300" id="uploadMediaModalBtn">Upload Media</button>
                    <button type="submit" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors duration-300" id="submitProductModalBtn" disabled>Submit Product</button>
                </div>
            </form>
            
            <!-- Product Preview -->
            <div id="productPreview" class="product-preview mt-4" style="display: none;">
                <h3 class="text-xl font-semibold mb-2">Product Preview</h3>
                <div id="previewContent"></div>
            </div>
        </div>
    </div>

    <!-- View Purchases Modal -->
    <div id="viewPurchasesModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeViewPurchases">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Customer Purchases</h2>
            <div id="purchasesList" class="space-y-4">
                <!-- Purchases will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- Check Products Modal -->
    <div id="checkProductsModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeCheckProducts">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Manage Products</h2>
            <div id="uploadedProductsList" class="uploaded-products">
                <!-- Products will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- View Messages Modal -->
    <div id="viewMessagesModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeViewMessages">&times;</span>
            <h2 class="text-2xl font-bold mb-4">Customer Messages</h2>
            <div id="messagesList" class="space-y-4">
                <!-- Messages will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- Self Destruct Password Modal -->
    <div id="selfDestructModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeSelfDestructModal">&times;</span>
            <h2 class="text-2xl font-bold mb-4 text-red-600">Self Destruct</h2>
            <p class="mb-4">This action will permanently delete all data and make the website blank. Please enter the self destruct password:</p>
            <input type="password" id="selfDestructPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all duration-300 mb-4" placeholder="Password">
            <button id="submitSelfDestruct" class="w-full bg-red-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-red-700 transition-colors duration-300">Confirm Self Destruct</button>
            <p id="selfDestructError" class="text-red-500 mt-2 hidden">Incorrect password. Please try again.</p>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Initialize data
        let products = [];
        let cart = [];
        let orders = [];
        let currentProduct = null;
        let adminLoggedIn = false;
        let mediaFiles = [];
        let mediaFilesModal = [];
        let mediaUploaded = false;
        let mediaUploadedModal = false;
        let syncInterval = null;
        
        // Default admin password (in a real application, this would be handled securely on the server)
        const ADMIN_PASSWORD = "admin123";
        const SELF_DESTRUCT_PASSWORD = "destruct123";
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from server
            loadProductsFromServer();
            
            // Initialize the app
            initializeApp();
            
            // Set up event listeners
            setupEventListeners();
            
            // Set up periodic sync with server
            setupPeriodicSync();
        });
        
        // Set up periodic sync with server
        function setupPeriodicSync() {
            // Sync with server every 30 seconds
            syncInterval = setInterval(() => {
                loadProductsFromServer();
            }, 30000);
        }
        
        // Load products from server
        function loadProductsFromServer() {
            fetch('/api/products')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(serverProducts => {
                    products = serverProducts;
                    localStorage.setItem('products', JSON.stringify(products));
                    
                    // Refresh the current view if needed
                    refreshCurrentView();
                })
                .catch(error => {
                    console.error('Error loading products from server:', error);
                    // If server is unavailable, try to load from localStorage
                    const savedProducts = localStorage.getItem('products');
                    if (savedProducts) {
                        products = JSON.parse(savedProducts);
                    } else {
                        // Initialize with sample products if no products exist
                        initializeSampleProducts();
                    }
                })
                .finally(() => {
                    // Load cart and orders from localStorage
                    const savedCart = localStorage.getItem('cart');
                    const savedOrders = localStorage.getItem('orders');
                    
                    if (savedCart) {
                        cart = JSON.parse(savedCart);
                    }
                    
                    if (savedOrders) {
                        orders = JSON.parse(savedOrders);
                    }
                    
                    // Update cart count
                    updateCartCount();
                });
        }
        
        // Refresh current view based on active page
        function refreshCurrentView() {
            const homePage = document.getElementById('homePage');
            const productDetailPage = document.getElementById('productDetailPage');
            const cartPage = document.getElementById('cartPage');
            const adminPanel = document.getElementById('adminPanel');
            
            if (homePage.style.display !== 'none') {
                loadFeaturedProducts();
            } else if (productDetailPage.style.display !== 'none' && currentProduct) {
                // Refresh product detail if it's still available
                const product = products.find(p => p.id === currentProduct.id);
                if (product) {
                    currentProduct = product;
                    document.getElementById('productDetailImage').src = product.image;
                    document.getElementById('productDetailTitle').textContent = product.name;
                    document.getElementById('productDetailPrice').textContent = `$${product.price}`;
                    document.getElementById('productDetailDescription').textContent = product.description;
                    loadSizeOptions(product.sizes);
                    loadProductReviews(product.reviews);
                } else {
                    // Product was deleted, go back to home page
                    showHomePage();
                    showNotification('This product is no longer available');
                }
            } else if (cartPage.style.display !== 'none') {
                loadCartItems();
                updateCartSummary();
            } else if (adminPanel.style.display !== 'none') {
                loadAdminProducts();
            }
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('cart', JSON.stringify(cart));
            localStorage.setItem('orders', JSON.stringify(orders));
        }
        
        // Initialize sample products
        function initializeSampleProducts() {
            products = [
                {
                    id: 1,
                    name: "Classic White T-Shirt",
                    price: 19.99,
                    category: "men",
                    image: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=980&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=980&q=80" },
                        { type: 'image', url: "https://images.unsplash.com/photo-1549298916-b41d501d3772?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=988&q=80" }
                    ],
                    description: "A classic white t-shirt made from 100% cotton. Perfect for casual wear.",
                    sizes: ["S", "M", "L", "XL"],
                    reviews: [
                        {
                            name: "John Doe",
                            date: "2025-05-15",
                            rating: 5,
                            comment: "Great quality t-shirt, fits perfectly!"
                        },
                        {
                            name: "Jane Smith",
                            date: "2025-05-10",
                            rating: 4,
                            comment: "Good value for money, but a bit thin."
                        }
                    ]
                },
                {
                    id: 2,
                    name: "Denim Jacket",
                    price: 49.99,
                    category: "women",
                    image: "https://images.unsplash.com/photo-1551537482-f2075a1d41f2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1551537482-f2075a1d41f2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80" },
                        { type: 'video', url: "https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4" }
                    ],
                    description: "Stylish denim jacket with a modern fit. Perfect for layering.",
                    sizes: ["XS", "S", "M", "L"],
                    reviews: [
                        {
                            name: "Emily Johnson",
                            date: "2025-05-12",
                            rating: 5,
                            comment: "Love this jacket! It's my new favorite."
                        }
                    ]
                },
                {
                    id: 3,
                    name: "Kids' Graphic T-Shirt",
                    price: 14.99,
                    category: "kids",
                    image: "https://images.unsplash.com/photo-1604698012724-0d3a712864f9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1604698012724-0d3a712864f9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80" }
                    ],
                    description: "Fun graphic t-shirt for kids. Made from soft, comfortable fabric.",
                    sizes: ["2T", "3T", "4T", "5T"],
                    reviews: []
                },
                {
                    id: 4,
                    name: "Leather Handbag",
                    price: 79.99,
                    category: "accessories",
                    image: "https://images.unsplash.com/photo-1584917865442-de89df76afd3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=988&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1584917865442-de89df76afd3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=988&q=80" },
                        { type: 'image', url: "https://images.unsplash.com/photo-1590854272585-4aad9caf0efe?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80" },
                        { type: 'video', url: "https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4" }
                    ],
                    description: "Elegant leather handbag with plenty of space for all your essentials.",
                    sizes: ["One Size"],
                    reviews: [
                        {
                            name: "Sarah Williams",
                            date: "2025-05-08",
                            rating: 4,
                            comment: "Beautiful bag, but a bit smaller than expected."
                        }
                    ]
                },
                {
                    id: 5,
                    name: "Summer Dress",
                    price: 39.99,
                    category: "sale",
                    originalPrice: 59.99,
                    image: "https://images.unsplash.com/photo-1611312449408-fcece27cdbb7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1611312449408-fcece27cdbb7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=987&q=80" },
                        { type: 'video', url: "https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4" }
                    ],
                    description: "Light and breezy summer dress, perfect for warm weather.",
                    sizes: ["XS", "S", "M", "L", "XL"],
                    reviews: [
                        {
                            name: "Lisa Brown",
                            date: "2025-05-05",
                            rating: 5,
                            comment: "Perfect for summer! Great fit and quality."
                        }
                    ]
                },
                {
                    id: 6,
                    name: "Casual Sneakers",
                    price: 59.99,
                    category: "men",
                    image: "https://images.unsplash.com/photo-1549298916-b41d501d3772?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=988&q=80",
                    media: [
                        { type: 'image', url: "https://images.unsplash.com/photo-1549298916-b41d501d3772?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=988&q=80" }
                    ],
                    description: "Comfortable casual sneakers that go with any outfit.",
                    sizes: ["8", "9", "10", "11", "12"],
                    reviews: []
                }
            ];
            
            // Save sample products to localStorage
            localStorage.setItem('products', JSON.stringify(products));
        }
        
        // Initialize the app
        function initializeApp() {
            // Show home page
            showHomePage();
        }
        
        // Set up event listeners
        function setupEventListeners() {
            // Navigation links
            document.getElementById('homeLink').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
                resetCategoryTitle();
            });
            
            // Category buttons in the header
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    showCategoryPage(category);
                });
            });
            
            // Cart link
            document.getElementById('cartLink').addEventListener('click', function(e) {
                e.preventDefault();
                showCartPage();
            });
            
            // Shop Now button
            document.getElementById('shopNowBtn').addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            
            // Add to Cart button
            document.getElementById('addToCartBtn').addEventListener('click', function() {
                if (currentProduct) {
                    const selectedSize = document.querySelector('.size-option.active');
                    if (!selectedSize) {
                        showNotification('Please select a size');
                        return;
                    }
                    
                    addToCart(currentProduct.id, selectedSize.textContent);
                    showNotification('Product added to cart');
                }
            });
            
            // Buy Now button
            document.getElementById('buyNowBtn').addEventListener('click', function() {
                if (currentProduct) {
                    const selectedSize = document.querySelector('.size-option.active');
                    if (!selectedSize) {
                        showNotification('Please select a size');
                        return;
                    }
                    
                    addToCart(currentProduct.id, selectedSize.textContent);
                    showCartPage();
                }
            });
            
            // Checkout button
            document.getElementById('checkoutBtn').addEventListener('click', function() {
                showCheckoutPage();
            });
            
            // Back to Cart button
            document.getElementById('backToCartBtn').addEventListener('click', function() {
                showCartPage();
            });
            
            // Checkout form
            document.getElementById('checkoutForm').addEventListener('submit', function(e) {
                e.preventDefault();
                processOrder();
            });
            
            // Continue Shopping button
            document.getElementById('continueShoppingBtn').addEventListener('click', function() {
                showHomePage();
            });
            
            // Admin trigger (hidden)
            document.getElementById('adminTrigger').addEventListener('click', function() {
                if (!adminLoggedIn) {
                    document.getElementById('passwordModal').style.display = 'block';
                } else {
                    showAdminPanel();
                }
            });
            
            // Admin button (visible on hover)
            document.getElementById('adminButton').addEventListener('click', function() {
                if (!adminLoggedIn) {
                    document.getElementById('passwordModal').style.display = 'block';
                } else {
                    showAdminPanel();
                }
            });
            
            // Admin login form
            document.getElementById('submitPassword').addEventListener('click', function() {
                const password = document.getElementById('adminPassword').value;
                
                if (password === ADMIN_PASSWORD) {
                    adminLoggedIn = true;
                    document.getElementById('passwordModal').style.display = 'none';
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('passwordError').classList.add('hidden');
                    
                    // Show admin button at top left
                    document.getElementById('adminButton').classList.add('visible');
                } else {
                    document.getElementById('passwordError').classList.remove('hidden');
                }
            });
            
            // Admin dashboard cards
            document.getElementById('uploadProductCard').addEventListener('click', function() {
                document.getElementById('uploadProductModal').style.display = 'block';
            });
            
            document.getElementById('viewPurchasesCard').addEventListener('click', function() {
                loadPurchases();
                document.getElementById('viewPurchasesModal').style.display = 'block';
            });
            
            document.getElementById('manageProductsCard').addEventListener('click', function() {
                loadAdminProductsForModal();
                document.getElementById('checkProductsModal').style.display = 'block';
            });
            
            document.getElementById('viewMessagesCard').addEventListener('click', function() {
                loadMessages();
                document.getElementById('viewMessagesModal').style.display = 'block';
            });
            
            document.getElementById('selfDestructCard').addEventListener('click', function() {
                document.getElementById('selfDestructModal').style.display = 'block';
            });
            
            // Self destruct form
            document.getElementById('submitSelfDestruct').addEventListener('click', function() {
                const password = document.getElementById('selfDestructPassword').value;
                
                if (password === SELF_DESTRUCT_PASSWORD) {
                    // Clear all data
                    localStorage.clear();
                    products = [];
                    cart = [];
                    orders = [];
                    saveData();
                    
                    // Show notification
                    showNotification('All data has been deleted. Refreshing page...');
                    
                    // Refresh page after delay
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                } else {
                    document.getElementById('selfDestructError').classList.remove('hidden');
                }
            });
            
            // Admin tabs
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showAdminTab(tabName);
                });
            });
            
            // Add product form
            document.getElementById('addProductForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addProduct();
            });
            
            // Upload media button for admin panel
            document.getElementById('uploadMediaBtn').addEventListener('click', function() {
                document.getElementById('productMedia').click();
            });
            
            // Upload media button for modal
            document.getElementById('uploadMediaModalBtn').addEventListener('click', function() {
                document.getElementById('productMediaModal').click();
            });
            
            // Image upload preview for admin panel
            document.getElementById('productMedia').addEventListener('change', function(e) {
                handleMediaUpload(e, 'mediaGallery', 'uploadMediaBtn', 'submitProductBtn');
            });
            
            // Image upload preview for modal
            document.getElementById('productMediaModal').addEventListener('change', function(e) {
                handleMediaUpload(e, 'mediaGalleryModal', 'uploadMediaModalBtn', 'submitProductModalBtn');
            });
            
            // Modal close buttons
            document.getElementById('closePasswordModal').addEventListener('click', function() {
                document.getElementById('passwordModal').style.display = 'none';
            });
            
            document.getElementById('closeUploadProduct').addEventListener('click', function() {
                document.getElementById('uploadProductModal').style.display = 'none';
                // Reset media files when closing modal
                mediaFilesModal = [];
                document.getElementById('mediaGalleryModal').innerHTML = '';
                mediaUploadedModal = false;
                document.getElementById('submitProductModalBtn').disabled = true;
            });
            
            document.getElementById('closeViewPurchases').addEventListener('click', function() {
                document.getElementById('viewPurchasesModal').style.display = 'none';
            });
            
            document.getElementById('closeCheckProducts').addEventListener('click', function() {
                document.getElementById('checkProductsModal').style.display = 'none';
            });
            
            document.getElementById('closeViewMessages').addEventListener('click', function() {
                document.getElementById('viewMessagesModal').style.display = 'none';
            });
            
            document.getElementById('closeSelfDestructModal').addEventListener('click', function() {
                document.getElementById('selfDestructModal').style.display = 'none';
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    if (event.target === modal) {
                        modal.style.display = 'none';
                        // Reset media files when closing modal
                        if (modal.id === 'uploadProductModal') {
                            mediaFilesModal = [];
                            document.getElementById('mediaGalleryModal').innerHTML = '';
                            mediaUploadedModal = false;
                            document.getElementById('submitProductModalBtn').disabled = true;
                        }
                    }
                });
            });
            
            // Keyboard shortcut for admin panel (Ctrl+Shift+A)
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    document.getElementById('adminTrigger').click();
                }
            });
        }
        
        // Handle media upload for both admin panel and modal
        function handleMediaUpload(event, galleryId, uploadBtnId, submitBtnId) {
            const files = event.target.files;
            const gallery = document.getElementById(galleryId);
            const uploadBtn = document.getElementById(uploadBtnId);
            const submitBtn = document.getElementById(submitBtnId);
            
            // Clear existing media if any
            if (galleryId === 'mediaGallery') {
                mediaFiles = [];
                gallery.innerHTML = '';
                mediaUploaded = false;
            } else {
                mediaFilesModal = [];
                gallery.innerHTML = '';
                mediaUploadedModal = false;
            }
            
            // Add new media files
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const mediaType = file.type.startsWith('image/') ? 'image' : 'video';
                    const mediaUrl = e.target.result;
                    
                    // Create media item
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    if (mediaType === 'image') {
                        mediaItem.innerHTML = `
                            <img src="${mediaUrl}" alt="Product image">
                            <button class="remove-media" data-index="${i}">×</button>
                            <span class="media-type">Image</span>
                        `;
                    } else {
                        mediaItem.innerHTML = `
                            <video src="${mediaUrl}" muted></video>
                            <button class="remove-media" data-index="${i}">×</button>
                            <span class="media-type">Video</span>
                        `;
                    }
                    
                    // Add remove button event listener
                    mediaItem.querySelector('.remove-media').addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        if (galleryId === 'mediaGallery') {
                            mediaFiles.splice(index, 1);
                            if (mediaFiles.length === 0) {
                                mediaUploaded = false;
                                submitBtn.disabled = true;
                            }
                        } else {
                            mediaFilesModal.splice(index, 1);
                            if (mediaFilesModal.length === 0) {
                                mediaUploadedModal = false;
                                submitBtn.disabled = true;
                            }
                        }
                        mediaItem.remove();
                    });
                    
                    gallery.appendChild(mediaItem);
                    
                    // Store media file
                    if (galleryId === 'mediaGallery') {
                        mediaFiles.push({
                            type: mediaType,
                            url: mediaUrl
                        });
                        mediaUploaded = true;
                        submitBtn.disabled = false;
                    } else {
                        mediaFilesModal.push({
                            type: mediaType,
                            url: mediaUrl
                        });
                        mediaUploadedModal = true;
                        submitBtn.disabled = false;
                    }
                };
                
                reader.readAsDataURL(file);
            }
            
            // Update button text
            uploadBtn.textContent = 'Change Media';
        }
        
        // Reset category title to "Featured Products"
        function resetCategoryTitle() {
            const sectionTitle = document.querySelector('#homePage .section-title');
            sectionTitle.textContent = 'Featured Products';
        }
        
        // Show home page
        function showHomePage() {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('heroSection').style.display = 'block';
            
            // Load featured products
            loadFeaturedProducts();
        }
        
        // Show category page
        function showCategoryPage(category) {
            hideAllPages();
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('heroSection').style.display = 'none';
            
            // Update section title
            const sectionTitle = document.querySelector('#homePage .section-title');
            sectionTitle.textContent = category.charAt(0).toUpperCase() + category.slice(1);
            
            // Load products by category
            loadProductsByCategory(category);
        }
        
        // Show product detail page
        function showProductDetailPage(productId) {
            hideAllPages();
            document.getElementById('productDetailPage').style.display = 'block';
            
            // Find product
            const product = products.find(p => p.id === productId);
            if (product) {
                currentProduct = product;
                
                // Update product details
                document.getElementById('productDetailImage').src = product.image;
                document.getElementById('productDetailTitle').textContent = product.name;
                document.getElementById('productDetailPrice').textContent = `$${product.price}`;
                document.getElementById('productDetailDescription').textContent = product.description;
                
                // Load size options
                loadSizeOptions(product.sizes);
                
                // Load reviews
                loadProductReviews(product.reviews);
            }
        }
        
        // Show cart page
        function showCartPage() {
            hideAllPages();
            document.getElementById('cartPage').style.display = 'block';
            
            // Load cart items
            loadCartItems();
            
            // Update cart summary
            updateCartSummary();
        }
        
        // Show checkout page
        function showCheckoutPage() {
            if (cart.length === 0) {
                showNotification('Your cart is empty');
                return;
            }
            
            hideAllPages();
            document.getElementById('checkoutPage').style.display = 'block';
            
            // Load cart items in checkout
            loadCheckoutCartItems();
            
            // Update checkout summary
            updateCheckoutSummary();
        }
        
        // Show confirmation page
        function showConfirmationPage(orderId) {
            hideAllPages();
            document.getElementById('confirmationPage').style.display = 'block';
            
            // Update order ID
            document.getElementById('orderId').textContent = orderId;
        }
        
        // Show admin panel
        function showAdminPanel() {
            hideAllPages();
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('heroSection').style.display = 'none';
            
            // Load admin products
            loadAdminProducts();
            
            // Load order history
            loadOrderHistory();
        }
        
        // Show admin tab
        function showAdminTab(tabName) {
            // Update active tab
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            // Update active tab content
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }
        
        // Hide all pages
        function hideAllPages() {
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('productDetailPage').style.display = 'none';
            document.getElementById('cartPage').style.display = 'none';
            document.getElementById('checkoutPage').style.display = 'none';
            document.getElementById('confirmationPage').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('heroSection').style.display = 'none';
        }
        
        // Load featured products
        function loadFeaturedProducts() {
            const container = document.getElementById('featuredProducts');
            container.innerHTML = '';
            
            // Get first 6 products
            const featuredProducts = products.slice(0, 6);
            
            featuredProducts.forEach(product => {
                const productCard = createProductCard(product);
                container.appendChild(productCard);
            });
        }
        
        // Load products by category
        function loadProductsByCategory(category) {
            const container = document.getElementById('featuredProducts');
            container.innerHTML = '';
            
            // Filter products by category
            const filteredProducts = products.filter(p => p.category === category);
            
            filteredProducts.forEach(product => {
                const productCard = createProductCard(product);
                container.appendChild(productCard);
            });
        }
        
        // Create product card
        function createProductCard(product) {
            const col = document.createElement('div');
            col.className = 'col-md-4 col-sm-6';
            
            let priceHtml = `<div class="price">$${product.price}</div>`;
            
            if (product.originalPrice) {
                priceHtml = `
                    <div class="price">
                        <span style="text-decoration: line-through; color: #777;">$${product.originalPrice}</span>
                        $${product.price}
                    </div>
                `;
            }
            
            col.innerHTML = `
                <div class="product-card">
                    <img src="${product.image}" alt="${product.name}">
                    <div class="card-body">
                        <h5 class="card-title">${product.name}</h5>
                        ${priceHtml}
                        <button class="btn btn-primary add-to-cart-btn" data-product-id="${product.id}">Add to Cart</button>
                        <button class="btn btn-outline-primary view-details-btn" data-product-id="${product.id}">View Details</button>
                    </div>
                </div>
            `;
            
            // Add event listeners
            col.querySelector('.add-to-cart-btn').addEventListener('click', function() {
                const productId = parseInt(this.getAttribute('data-product-id'));
                const product = products.find(p => p.id === productId);
                
                if (product.sizes && product.sizes.length > 0) {
                    // If product has sizes, show product detail page
                    showProductDetailPage(productId);
                } else {
                    // If no sizes, add directly to cart
                    addToCart(productId, 'One Size');
                    showNotification('Product added to cart');
                }
            });
            
            col.querySelector('.view-details-btn').addEventListener('click', function() {
                const productId = parseInt(this.getAttribute('data-product-id'));
                showProductDetailPage(productId);
            });
            
            return col;
        }
        
        // Load size options
        function loadSizeOptions(sizes) {
            const container = document.getElementById('sizeOptions');
            container.innerHTML = '';
            
            sizes.forEach(size => {
                const sizeOption = document.createElement('div');
                sizeOption.className = 'size-option';
                sizeOption.textContent = size;
                
                sizeOption.addEventListener('click', function() {
                    document.querySelectorAll('.size-option').forEach(option => {
                        option.classList.remove('active');
                    });
                    this.classList.add('active');
                });
                
                container.appendChild(sizeOption);
            });
        }
        
        // Load product reviews
        function loadProductReviews(reviews) {
            const container = document.getElementById('productReviews');
            container.innerHTML = '';
            
            if (reviews.length === 0) {
                container.innerHTML = '<p>No reviews yet. Be the first to review this product!</p>';
                return;
            }
            
            reviews.forEach(review => {
                const reviewElement = document.createElement('div');
                reviewElement.className = 'review';
                
                let starsHtml = '';
                for (let i = 1; i <= 5; i++) {
                    if (i <= review.rating) {
                        starsHtml += '<i class="bi bi-star-fill rating"></i>';
                    } else {
                        starsHtml += '<i class="bi bi-star rating"></i>';
                    }
                }
                
                reviewElement.innerHTML = `
                    <div class="review-header">
                        <span class="reviewer-name">${review.name}</span>
                        <span class="review-date">${review.date}</span>
                    </div>
                    <div class="rating">${starsHtml}</div>
                    <p>${review.comment}</p>
                `;
                
                container.appendChild(reviewElement);
            });
        }
        
        // Add product to cart
        function addToCart(productId, size) {
            const existingItem = cart.find(item => item.productId === productId && item.size === size);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                const product = products.find(p => p.id === productId);
                cart.push({
                    productId: productId,
                    name: product.name,
                    price: product.price,
                    image: product.image,
                    size: size,
                    quantity: 1
                });
            }
            
            saveData();
            updateCartCount();
        }
        
        // Update cart count
        function updateCartCount() {
            const count = cart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }
        
        // Load cart items
        function loadCartItems() {
            const container = document.getElementById('cartItems');
            container.innerHTML = '';
            
            if (cart.length === 0) {
                container.innerHTML = '<p>Your cart is empty</p>';
                return;
            }
            
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-item-details">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-price">$${item.price}</div>
                        <div>Size: ${item.size}</div>
                        <div class="quantity-control">
                            <button class="decrease-quantity" data-product-id="${item.productId}" data-size="${item.size}">-</button>
                            <input type="text" value="${item.quantity}" readonly>
                            <button class="increase-quantity" data-product-id="${item.productId}" data-size="${item.size}">+</button>
                            <button class="btn btn-sm btn-outline-danger ms-3 remove-item" data-product-id="${item.productId}" data-size="${item.size}">Remove</button>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                cartItem.querySelector('.decrease-quantity').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    const size = this.getAttribute('data-size');
                    updateCartItemQuantity(productId, size, -1);
                });
                
                cartItem.querySelector('.increase-quantity').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    const size = this.getAttribute('data-size');
                    updateCartItemQuantity(productId, size, 1);
                });
                
                cartItem.querySelector('.remove-item').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    const size = this.getAttribute('data-size');
                    removeCartItem(productId, size);
                });
                
                container.appendChild(cartItem);
            });
        }
        
        // Update cart item quantity
        function updateCartItemQuantity(productId, size, change) {
            const item = cart.find(item => item.productId === productId && item.size === size);
            
            if (item) {
                item.quantity += change;
                
                if (item.quantity <= 0) {
                    removeCartItem(productId, size);
                } else {
                    saveData();
                    loadCartItems();
                    updateCartSummary();
                    updateCartCount();
                }
            }
        }
        
        // Remove cart item
        function removeCartItem(productId, size) {
            cart = cart.filter(item => !(item.productId === productId && item.size === size));
            saveData();
            loadCartItems();
            updateCartSummary();
            updateCartCount();
        }
        
        // Update cart summary
        function updateCartSummary() {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = subtotal > 0 ? 5.99 : 0;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('shipping').textContent = `$${shipping.toFixed(2)}`;
            document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('total').textContent = `$${total.toFixed(2)}`;
        }
        
        // Load checkout cart items
        function loadCheckoutCartItems() {
            const container = document.getElementById('checkoutCartItems');
            container.innerHTML = '';
            
            cart.forEach(item => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-item-details">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-price">$${item.price} x ${item.quantity}</div>
                        <div>Size: ${item.size}</div>
                    </div>
                `;
                
                container.appendChild(cartItem);
            });
        }
        
        // Update checkout summary
        function updateCheckoutSummary() {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = subtotal > 0 ? 5.99 : 0;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            document.getElementById('checkoutSubtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('checkoutShipping').textContent = `$${shipping.toFixed(2)}`;
            document.getElementById('checkoutTax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('checkoutTotal').textContent = `$${total.toFixed(2)}`;
        }
        
        // Process order
        function processOrder() {
            // Get form data
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const email = document.getElementById('email').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            const zip = document.getElementById('zip').value;
            const cardName = document.getElementById('cardName').value;
            const cardNumber = document.getElementById('cardNumber').value;
            const expiry = document.getElementById('expiry').value;
            const cvv = document.getElementById('cvv').value;
            
            // Calculate totals
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const shipping = subtotal > 0 ? 5.99 : 0;
            const tax = subtotal * 0.08;
            const total = subtotal + shipping + tax;
            
            // Generate order ID
            const orderId = 'ORD-' + Date.now();
            
            // Create order
            const order = {
                id: orderId,
                date: new Date().toISOString(),
                customer: {
                    firstName: firstName,
                    lastName: lastName,
                    email: email,
                    address: address,
                    city: city,
                    state: state,
                    zip: zip
                },
                items: [...cart],
                payment: {
                    cardName: cardName,
                    cardNumber: cardNumber.slice(-4), // Only store last 4 digits
                    expiry: expiry
                },
                totals: {
                    subtotal: subtotal,
                    shipping: shipping,
                    tax: tax,
                    total: total
                },
                status: 'Processing'
            };
            
            // Add order to orders array
            orders.push(order);
            
            // Clear cart
            cart = [];
            
            // Save data
            saveData();
            
            // Update cart count
            updateCartCount();
            
            // Show confirmation page
            showConfirmationPage(orderId);
        }
        
        // Add product (admin function)
        function addProduct() {
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productPrice').value);
            const category = document.getElementById('productCategory').value;
            const sizesInput = document.getElementById('productSizes').value;
            const description = document.getElementById('productDescription').value;
            
            // Process sizes input
            let sizes = [];
            if (sizesInput) {
                sizes = sizesInput.split(',').map(size => size.trim());
            } else {
                sizes = ["S", "M", "L"]; // Default sizes if none provided
            }
            
            // Check if media files were uploaded
            if (!mediaUploaded || mediaFiles.length === 0) {
                showNotification('Please upload at least one image or video');
                return;
            }
            
            // Create form data for server upload
            const formData = new FormData();
            formData.append('name', name);
            formData.append('price', price);
            formData.append('category', category);
            formData.append('sizes', sizes.join(','));
            formData.append('description', description);
            
            // Add media files to form data
            mediaFiles.forEach((media, index) => {
                // Convert data URL to blob
                const byteString = atob(media.url.split(',')[1]);
                const mimeString = media.url.split(',')[0].split(':')[1].split(';')[0];
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                
                for (let i = 0; i < byteString.length; i++) {
                    ia[i] = byteString.charCodeAt(i);
                }
                
                const blob = new Blob([ab], { type: mimeString });
                formData.append('media', blob, `media-${index}.${mimeString.split('/')[1]}`);
            });
            
            // Send product to server
            fetch('/api/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.message === 'Product added successfully') {
                    // Reload products from server to get the latest
                    loadProductsFromServer();
                    
                    // Reset form
                    document.getElementById('addProductForm').reset();
                    document.getElementById('mediaGallery').innerHTML = '';
                    mediaFiles = [];
                    mediaUploaded = false;
                    document.getElementById('uploadMediaBtn').textContent = 'Upload Media';
                    document.getElementById('submitProductBtn').disabled = true;
                    
                    // Show notification
                    showNotification('Product added successfully');
                } else {
                    showNotification('Failed to add product: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error adding product:', error);
                showNotification('Failed to add product');
            });
        }
        
        // Delete product (admin function)
        function deleteProduct(productId) {
            if (confirm('Are you sure you want to delete this product? This action cannot be undone.')) {
                // Send delete request to server
                fetch(`/api/products/${productId}`, {
                    method: 'DELETE'
                })
                .then(response => response.json())
                .then(data => {
                    if (data.message === 'Product deleted successfully') {
                        // Reload products from server to get the latest
                        loadProductsFromServer();
                        
                        // Show notification
                        showNotification('Product deleted successfully');
                    } else {
                        showNotification('Failed to delete product: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error deleting product:', error);
                    showNotification('Failed to delete product');
                });
            }
        }
        
        // Load admin products
        function loadAdminProducts() {
            const container = document.getElementById('adminProductList');
            container.innerHTML = '';
            
            products.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'admin-product-item';
                
                productItem.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <div class="admin-product-details">
                        <div><strong>${product.name}</strong></div>
                        <div>$${product.price}</div>
                        <div>${product.category}</div>
                        <div>Sizes: ${product.sizes.join(', ')}</div>
                        <div>Media: ${product.media ? product.media.length : 0} files</div>
                    </div>
                    <div class="admin-product-actions">
                        <button class="btn btn-sm btn-outline-primary edit-product" data-product-id="${product.id}">Edit</button>
                        <button class="btn btn-sm btn-danger delete-product" data-product-id="${product.id}">Delete</button>
                    </div>
                `;
                
                // Add event listeners
                productItem.querySelector('.edit-product').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    editProduct(productId);
                });
                
                productItem.querySelector('.delete-product').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    deleteProduct(productId);
                });
                
                container.appendChild(productItem);
            });
        }
        
        // Load admin products for modal
        function loadAdminProductsForModal() {
            const container = document.getElementById('uploadedProductsList');
            container.innerHTML = '';
            
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'product-card-admin';
                
                productCard.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <div class="card-body">
                        <h5 class="card-title">${product.name}</h5>
                        <div class="card-price">$${product.price}</div>
                        <div>Sizes: ${product.sizes.join(', ')}</div>
                        <div>Media: ${product.media ? product.media.length : 0} files</div>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-outline-primary edit-product-modal" data-product-id="${product.id}">Edit</button>
                            <button class="btn btn-sm btn-danger delete-product-modal" data-product-id="${product.id}">Delete</button>
                        </div>
                    </div>
                `;
                
                // Add event listeners
                productCard.querySelector('.edit-product-modal').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    editProductFromModal(productId);
                });
                
                productCard.querySelector('.delete-product-modal').addEventListener('click', function() {
                    const productId = parseInt(this.getAttribute('data-product-id'));
                    deleteProduct(productId);
                });
                
                container.appendChild(productCard);
            });
        }
        
        // Edit product (admin function)
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            
            if (product) {
                // Populate form with product data
                document.getElementById('productName').value = product.name;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productSizes').value = product.sizes.join(', ');
                document.getElementById('productDescription').value = product.description;
                
                // Load existing media files
                mediaFiles = [...product.media];
                const gallery = document.getElementById('mediaGallery');
                gallery.innerHTML = '';
                
                product.media.forEach((media, index) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    if (media.type === 'image') {
                        mediaItem.innerHTML = `
                            <img src="${media.url}" alt="Product image">
                            <button class="remove-media" data-index="${index}">×</button>
                            <span class="media-type">Image</span>
                        `;
                    } else {
                        mediaItem.innerHTML = `
                            <video src="${media.url}" muted></video>
                            <button class="remove-media" data-index="${index}">×</button>
                            <span class="media-type">Video</span>
                        `;
                    }
                    
                    // Add remove button event listener
                    mediaItem.querySelector('.remove-media').addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        mediaFiles.splice(index, 1);
                        if (mediaFiles.length === 0) {
                            mediaUploaded = false;
                            document.getElementById('submitProductBtn').disabled = true;
                        }
                        mediaItem.remove();
                    });
                    
                    gallery.appendChild(mediaItem);
                });
                
                // Update button states
                mediaUploaded = true;
                document.getElementById('uploadMediaBtn').textContent = 'Change Media';
                document.getElementById('submitProductBtn').disabled = false;
                
                // Change form behavior to update product
                const form = document.getElementById('addProductForm');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    
                    // Process sizes input
                    const sizesInput = document.getElementById('productSizes').value;
                    let sizes = [];
                    if (sizesInput) {
                        sizes = sizesInput.split(',').map(size => size.trim());
                    } else {
                        sizes = ["S", "M", "L"]; // Default sizes if none provided
                    }
                    
                    // Create form data for server upload
                    const formData = new FormData();
                    formData.append('name', document.getElementById('productName').value);
                    formData.append('price', parseFloat(document.getElementById('productPrice').value));
                    formData.append('category', document.getElementById('productCategory').value);
                    formData.append('sizes', sizes.join(','));
                    formData.append('description', document.getElementById('productDescription').value);
                    
                    // Add media files to form data
                    mediaFiles.forEach((media, index) => {
                        // Convert data URL to blob
                        const byteString = atob(media.url.split(',')[1]);
                        const mimeString = media.url.split(',')[0].split(':')[1].split(';')[0];
                        const ab = new ArrayBuffer(byteString.length);
                        const ia = new Uint8Array(ab);
                        
                        for (let i = 0; i < byteString.length; i++) {
                            ia[i] = byteString.charCodeAt(i);
                        }
                        
                        const blob = new Blob([ab], { type: mimeString });
                        formData.append('media', blob, `media-${index}.${mimeString.split('/')[1]}`);
                    });
                    
                    // Send update to server
                    fetch(`/api/products/${productId}`, {
                        method: 'PUT',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message === 'Product updated successfully') {
                            // Reload products from server to get the latest
                            loadProductsFromServer();
                            
                            // Reset form
                            form.reset();
                            gallery.innerHTML = '';
                            mediaFiles = [];
                            mediaUploaded = false;
                            document.getElementById('uploadMediaBtn').textContent = 'Upload Media';
                            document.getElementById('submitProductBtn').disabled = true;
                            form.onsubmit = null;
                            
                            // Show notification
                            showNotification('Product updated successfully');
                        } else {
                            showNotification('Failed to update product: ' + data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error updating product:', error);
                        showNotification('Failed to update product');
                    });
                };
                
                // Scroll to form
                form.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // Edit product from modal (admin function)
        function editProductFromModal(productId) {
            const product = products.find(p => p.id === productId);
            
            if (product) {
                // Close current modal
                document.getElementById('checkProductsModal').style.display = 'none';
                
                // Populate form with product data
                document.getElementById('productName').value = product.name;
                document.getElementById('productCost').value = product.price;
                document.getElementById('productSizesModal').value = product.sizes.join(', ');
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productDescription').value = product.description;
                
                // Load existing media files
                mediaFilesModal = [...product.media];
                const gallery = document.getElementById('mediaGalleryModal');
                gallery.innerHTML = '';
                
                product.media.forEach((media, index) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    
                    if (media.type === 'image') {
                        mediaItem.innerHTML = `
                            <img src="${media.url}" alt="Product image">
                            <button class="remove-media" data-index="${index}">×</button>
                            <span class="media-type">Image</span>
                        `;
                    } else {
                        mediaItem.innerHTML = `
                            <video src="${media.url}" muted></video>
                            <button class="remove-media" data-index="${index}">×</button>
                            <span class="media-type">Video</span>
                        `;
                    }
                    
                    // Add remove button event listener
                    mediaItem.querySelector('.remove-media').addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        mediaFilesModal.splice(index, 1);
                        if (mediaFilesModal.length === 0) {
                            mediaUploadedModal = false;
                            document.getElementById('submitProductModalBtn').disabled = true;
                        }
                        mediaItem.remove();
                    });
                    
                    gallery.appendChild(mediaItem);
                });
                
                // Update button states
                mediaUploadedModal = true;
                document.getElementById('uploadMediaModalBtn').textContent = 'Change Media';
                document.getElementById('submitProductModalBtn').disabled = false;
                
                // Change form behavior to update product
                const form = document.getElementById('productForm');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    
                    // Process sizes input
                    const sizesInput = document.getElementById('productSizesModal').value;
                    let sizes = [];
                    if (sizesInput) {
                        sizes = sizesInput.split(',').map(size => size.trim());
                    } else {
                        sizes = ["S", "M", "L"]; // Default sizes if none provided
                    }
                    
                    // Create form data for server upload
                    const formData = new FormData();
                    formData.append('name', document.getElementById('productName').value);
                    formData.append('price', parseFloat(document.getElementById('productCost').value));
                    formData.append('category', document.getElementById('productCategory').value);
                    formData.append('sizes', sizes.join(','));
                    formData.append('description', document.getElementById('productDescription').value);
                    
                    // Add media files to form data
                    mediaFilesModal.forEach((media, index) => {
                        // Convert data URL to blob
                        const byteString = atob(media.url.split(',')[1]);
                        const mimeString = media.url.split(',')[0].split(':')[1].split(';')[0];
                        const ab = new ArrayBuffer(byteString.length);
                        const ia = new Uint8Array(ab);
                        
                        for (let i = 0; i < byteString.length; i++) {
                            ia[i] = byteString.charCodeAt(i);
                        }
                        
                        const blob = new Blob([ab], { type: mimeString });
                        formData.append('media', blob, `media-${index}.${mimeString.split('/')[1]}`);
                    });
                    
                    // Send update to server
                    fetch(`/api/products/${productId}`, {
                        method: 'PUT',
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message === 'Product updated successfully') {
                            // Reload products from server to get the latest
                            loadProductsFromServer();
                            
                            // Reset form
                            form.reset();
                            gallery.innerHTML = '';
                            mediaFilesModal = [];
                            mediaUploadedModal = false;
                            document.getElementById('uploadMediaModalBtn').textContent = 'Upload Media';
                            document.getElementById('submitProductModalBtn').disabled = true;
                            form.onsubmit = null;
                            
                            // Close modal
                            document.getElementById('uploadProductModal').style.display = 'none';
                            
                            // Show notification
                            showNotification('Product updated successfully');
                        } else {
                            showNotification('Failed to update product: ' + data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error updating product:', error);
                        showNotification('Failed to update product');
                    });
                };
                
                // Open upload product modal
                document.getElementById('uploadProductModal').style.display = 'block';
            }
        }
        
        // Load order history (admin function)
        function loadOrderHistory() {
            const tbody = document.getElementById('orderHistoryTable');
            tbody.innerHTML = '';
            
            if (orders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center">No orders found</td></tr>';
                return;
            }
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                
                const date = new Date(order.date).toLocaleDateString();
                
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${date}</td>
                    <td>${order.customer.firstName} ${order.customer.lastName}</td>
                    <td>$${order.totals.total.toFixed(2)}</td>
                    <td>${order.status}</td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Load purchases (admin function)
        function loadPurchases() {
            const container = document.getElementById('purchasesList');
            container.innerHTML = '';
            
            if (orders.length === 0) {
                container.innerHTML = '<p>No purchases found</p>';
                return;
            }
            
            orders.forEach(order => {
                const orderElement = document.createElement('div');
                orderElement.className = 'border rounded-lg p-4';
                
                const date = new Date(order.date).toLocaleDateString();
                
                let itemsHtml = '';
                order.items.forEach(item => {
                    itemsHtml += `
                        <div class="d-flex align-items-center mb-2">
                            <img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
                            <div>
                                <div>${item.name}</div>
                                <div>$${item.price} x ${item.quantity}</div>
                            </div>
                        </div>
                    `;
                });
                
                orderElement.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div>
                            <h5 class="mb-1">Order ID: ${order.id}</h5>
                            <p class="text-muted mb-0">${date}</p>
                        </div>
                        <span class="badge bg-primary">${order.status}</span>
                    </div>
                    <div class="mb-3">
                        <h6>Customer: ${order.customer.firstName} ${order.customer.lastName}</h6>
                        <p class="mb-0">${order.customer.email}</p>
                    </div>
                    <div class="mb-3">
                        <h6>Items:</h6>
                        ${itemsHtml}
                    </div>
                    <div class="d-flex justify-content-between">
                        <div>
                            <strong>Total: $${order.totals.total.toFixed(2)}</strong>
                        </div>
                        <button class="btn btn-sm btn-outline-primary">View Details</button>
                    </div>
                `;
                
                container.appendChild(orderElement);
            });
        }
        
        // Load messages (admin function)
        function loadMessages() {
            const container = document.getElementById('messagesList');
            container.innerHTML = '';
            
            // For demo purposes, we'll create some sample messages
            const messages = [
                {
                    id: 1,
                    name: "John Doe",
                    email: "john@example.com",
                    date: "2025-05-15",
                    subject: "Question about product availability",
                    message: "Hi, I'm interested in the Classic White T-Shirt. Do you have it in size XL?"
                },
                {
                    id: 2,
                    name: "Jane Smith",
                    email: "jane@example.com",
                    date: "2025-05-10",
                    subject: "Return request",
                    message: "I would like to return the Denim Jacket I purchased last week. The size doesn't fit me."
                },
                {
                    id: 3,
                    name: "Bob Johnson",
                    email: "bob@example.com",
                    date: "2025-05-05",
                    subject: "Shipping inquiry",
                    message: "Can you please provide an update on my order status? It's been 5 days and I haven't received it yet."
                }
            ];
            
            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = 'border rounded-lg p-4';
                
                const date = new Date(message.date).toLocaleDateString();
                
                messageElement.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <div>
                            <h5 class="mb-1">${message.subject}</h5>
                            <p class="text-muted mb-0">${date}</p>
                        </div>
                        <span class="badge bg-secondary">New</span>
                    </div>
                    <div class="mb-3">
                        <h6>From: ${message.name} (${message.email})</h6>
                    </div>
                    <div class="mb-3">
                        <p>${message.message}</p>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-sm btn-primary me-2">Reply</button>
                        <button class="btn btn-sm btn-outline-secondary">Mark as Read</button>
                    </div>
                `;
                
                container.appendChild(messageElement);
            });
        }
        
        // Upload product from modal (admin function)
        function uploadProductFromModal() {
            const name = document.getElementById('productName').value;
            const price = parseFloat(document.getElementById('productCost').value);
            const sizesInput = document.getElementById('productSizesModal').value;
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            
            // Process sizes input
            let sizes = [];
            if (sizesInput) {
                sizes = sizesInput.split(',').map(size => size.trim());
            } else {
                sizes = ["S", "M", "L"]; // Default sizes if none provided
            }
            
            // Check if media files were uploaded
            if (!mediaUploadedModal || mediaFilesModal.length === 0) {
                showNotification('Please upload at least one image or video');
                return;
            }
            
            // Create form data for server upload
            const formData = new FormData();
            formData.append('name', name);
            formData.append('price', price);
            formData.append('category', category);
            formData.append('sizes', sizes.join(','));
            formData.append('description', description);
            
            // Add media files to form data
            mediaFilesModal.forEach((media, index) => {
                // Convert data URL to blob
                const byteString = atob(media.url.split(',')[1]);
                const mimeString = media.url.split(',')[0].split(':')[1].split(';')[0];
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                
                for (let i = 0; i < byteString.length; i++) {
                    ia[i] = byteString.charCodeAt(i);
                }
                
                const blob = new Blob([ab], { type: mimeString });
                formData.append('media', blob, `media-${index}.${mimeString.split('/')[1]}`);
            });
            
            // Send product to server
            fetch('/api/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.message === 'Product added successfully') {
                    // Reload products from server to get the latest
                    loadProductsFromServer();
                    
                    // Reset form
                    document.getElementById('productForm').reset();
                    document.getElementById('productPreview').style.display = 'none';
                    document.getElementById('mediaGalleryModal').innerHTML = '';
                    mediaFilesModal = [];
                    mediaUploadedModal = false;
                    document.getElementById('uploadMediaModalBtn').textContent = 'Upload Media';
                    document.getElementById('submitProductModalBtn').disabled = true;
                    
                    // Close modal
                    document.getElementById('uploadProductModal').style.display = 'none';
                    
                    // Show notification
                    showNotification('Product uploaded successfully');
                } else {
                    showNotification('Failed to upload product: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error uploading product:', error);
                showNotification('Failed to upload product');
            });
        }
        
        // Preview product (admin function)
        function previewProduct() {
            const name = document.getElementById('productName').value;
            const price = document.getElementById('productCost').value;
            const sizesInput = document.getElementById('productSizesModal').value;
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            
            // Process sizes input
            let sizes = [];
            if (sizesInput) {
                sizes = sizesInput.split(',').map(size => size.trim());
            } else {
                sizes = ["S", "M", "L"]; // Default sizes if none provided
            }
            
            // Get media files
            const mediaFiles = mediaFilesModal;
            
            let mediaHtml = '';
            if (mediaFiles.length > 0) {
                // Display first media as main image/video
                if (mediaFiles[0].type === 'image') {
                    mediaHtml = `<img src="${mediaFiles[0].url}" alt="${name}" style="max-width: 100%; max-height: 200px; border-radius: 8px;">`;
                } else {
                    mediaHtml = `<video src="${mediaFiles[0].url}" controls style="max-width: 100%; max-height: 200px; border-radius: 8px;"></video>`;
                }
            }
            
            // Create thumbnail gallery
            let thumbnailsHtml = '';
            if (mediaFiles.length > 1) {
                thumbnailsHtml = '<div class="mt-2"><h6>Media Gallery:</h6><div class="d-flex flex-wrap gap-1">';
                
                for (let i = 1; i < mediaFiles.length; i++) {
                    if (mediaFiles[i].type === 'image') {
                        thumbnailsHtml += `<img src="${mediaFiles[i].url}" alt="Product image" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px;">`;
                    } else {
                        thumbnailsHtml += `<div style="width: 50px; height: 50px; background-color: #f0f0f0; border-radius: 4px; display: flex; align-items: center; justify-content: center;"><i class="fas fa-video"></i></div>`;
                    }
                }
                
                thumbnailsHtml += '</div></div>';
            }
            
            // Update preview content
            document.getElementById('previewContent').innerHTML = `
                <div class="product-card">
                    ${mediaHtml}
                    <div class="card-body">
                        <h5 class="card-title">${name}</h5>
                        <div class="price">$${price}</div>
                        <p>${description}</p>
                        <div>Sizes: ${sizes.join(', ')}</div>
                        <div>Category: ${category}</div>
                        ${thumbnailsHtml}
                    </div>
                </div>
            `;
            
            // Show preview
            document.getElementById('productPreview').style.display = 'block';
        }
        
        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
